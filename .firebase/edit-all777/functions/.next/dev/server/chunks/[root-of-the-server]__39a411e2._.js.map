{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/yongwoo.kim/Downloads/loop/src/app/api/feedback/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport https from 'https';\n\nexport async function POST(request: Request) {\n    try {\n        const { body } = await request.json();\n        let apiKey = process.env.RESEND_API_KEY;\n\n        if (!apiKey) {\n            return NextResponse.json({ error: 'API Key Missing' }, { status: 500 });\n        }\n\n        apiKey = apiKey.trim();\n\n        // fetch 대신 Node.js 기본 https 모듈을 사용하여 SSL 인증서 검증을 무시하도록 설정합니다.\n        const postData = JSON.stringify({\n            from: 'onboarding@resend.dev',\n            to: 'xmforxm98@gmail.com',\n            subject: 'New Feedback from Loop',\n            text: body,\n        });\n\n        const options = {\n            hostname: 'api.resend.com',\n            path: '/emails',\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${apiKey}`,\n                'Content-Type': 'application/json',\n                'Content-Length': Buffer.byteLength(postData),\n            },\n            // SSL 인증서 문제를 해결하기 위해 검증을 건너뜁니다.\n            rejectUnauthorized: false\n        };\n\n        const result = await new Promise((resolve, reject) => {\n            const req = https.request(options, (res) => {\n                let data = '';\n                res.on('data', (chunk) => { data += chunk; });\n                res.on('end', () => {\n                    try {\n                        const parsed = JSON.parse(data);\n                        if (res.statusCode && res.statusCode >= 200 && res.statusCode < 300) {\n                            resolve({ success: true, data: parsed });\n                        } else {\n                            resolve({ success: false, status: res.statusCode, details: parsed });\n                        }\n                    } catch (e) {\n                        resolve({ success: false, status: res.statusCode, details: data });\n                    }\n                });\n            });\n\n            req.on('error', (e) => {\n                reject(e);\n            });\n\n            req.write(postData);\n            req.end();\n        });\n\n        const typedResult = result as any;\n        if (!typedResult.success) {\n            return NextResponse.json({ error: 'Resend API Error', details: typedResult.details }, { status: typedResult.status || 500 });\n        }\n\n        return NextResponse.json(typedResult);\n    } catch (error) {\n        console.error('Feedback Flow Error:', error);\n        return NextResponse.json({\n            error: 'Feedback Flow Error',\n            details: error instanceof Error ? error.message : String(error)\n        }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QACnC,IAAI,SAAS,QAAQ,GAAG,CAAC,cAAc;QAEvC,IAAI,CAAC,QAAQ;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,SAAS,OAAO,IAAI;QAEpB,8DAA8D;QAC9D,MAAM,WAAW,KAAK,SAAS,CAAC;YAC5B,MAAM;YACN,IAAI;YACJ,SAAS;YACT,MAAM;QACV;QAEA,MAAM,UAAU;YACZ,UAAU;YACV,MAAM;YACN,QAAQ;YACR,SAAS;gBACL,iBAAiB,CAAC,OAAO,EAAE,QAAQ;gBACnC,gBAAgB;gBAChB,kBAAkB,OAAO,UAAU,CAAC;YACxC;YACA,iCAAiC;YACjC,oBAAoB;QACxB;QAEA,MAAM,SAAS,MAAM,IAAI,QAAQ,CAAC,SAAS;YACvC,MAAM,MAAM,8GAAK,CAAC,OAAO,CAAC,SAAS,CAAC;gBAChC,IAAI,OAAO;gBACX,IAAI,EAAE,CAAC,QAAQ,CAAC;oBAAY,QAAQ;gBAAO;gBAC3C,IAAI,EAAE,CAAC,OAAO;oBACV,IAAI;wBACA,MAAM,SAAS,KAAK,KAAK,CAAC;wBAC1B,IAAI,IAAI,UAAU,IAAI,IAAI,UAAU,IAAI,OAAO,IAAI,UAAU,GAAG,KAAK;4BACjE,QAAQ;gCAAE,SAAS;gCAAM,MAAM;4BAAO;wBAC1C,OAAO;4BACH,QAAQ;gCAAE,SAAS;gCAAO,QAAQ,IAAI,UAAU;gCAAE,SAAS;4BAAO;wBACtE;oBACJ,EAAE,OAAO,GAAG;wBACR,QAAQ;4BAAE,SAAS;4BAAO,QAAQ,IAAI,UAAU;4BAAE,SAAS;wBAAK;oBACpE;gBACJ;YACJ;YAEA,IAAI,EAAE,CAAC,SAAS,CAAC;gBACb,OAAO;YACX;YAEA,IAAI,KAAK,CAAC;YACV,IAAI,GAAG;QACX;QAEA,MAAM,cAAc;QACpB,IAAI,CAAC,YAAY,OAAO,EAAE;YACtB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;gBAAoB,SAAS,YAAY,OAAO;YAAC,GAAG;gBAAE,QAAQ,YAAY,MAAM,IAAI;YAAI;QAC9H;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG,OAAO;QAC7D,GAAG;YAAE,QAAQ;QAAI;IACrB;AACJ"}}]
}